{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "api.snapshot.schema.json",
  "title": "HeatmapSnapshotResponse",
  "type": "object",
  "required": ["window", "points", "defaults"],
  "additionalProperties": false,
  "properties": {
    "window": {
      "type": "object",
      "required": ["start", "end", "timezone"],
      "additionalProperties": false,
      "properties": {
        "start": { "type": "string", "format": "date-time" },
        "end": { "type": "string", "format": "date-time" },
        "timezone": { "type": "string" }
      }
    },
    "defaults": {
      "type": "object",
      "required": ["color_mode", "trail_days"],
      "additionalProperties": false,
      "properties": {
        "color_mode": { "type": "string", "enum": ["MOMENTUM", "POLARIZATION", "CONFIDENCE"] },
        "trail_days": { "type": "integer", "enum": [7, 30, 90] }
      }
    },
    "points": {
      "type": "array",
      "items": { "$ref": "#/$defs/EntityPoint" }
    }
  },
  "$defs": {
    "EntityPoint": {
      "type": "object",
      "required": [
        "entity_id", "entity_key", "name", "type",
        "x_fame", "y_love",
        "momentum", "polarization", "confidence",
        "is_pinned", "is_dormant"
      ],
      "additionalProperties": false,
      "properties": {
        "entity_id": { "type": "string" },
        "entity_key": { "type": "string" },
        "name": { "type": "string" },
        "type": {
          "type": "string",
          "enum": ["PERSON", "SHOW", "FILM", "FRANCHISE", "NETWORK_STREAMER", "COUPLE", "BRAND", "CHARACTER"]
        },
        "x_fame": { "type": "number", "minimum": 0, "maximum": 100 },
        "y_love": { "type": "number", "minimum": 0, "maximum": 100 },
        "momentum": { "type": "number" },
        "polarization": { "type": "number", "minimum": 0, "maximum": 100 },
        "confidence": { "type": "number", "minimum": 0, "maximum": 100 },
        "attention": { "type": "number", "minimum": 0, "maximum": 100 },
        "baseline_fame": { "type": ["number", "null"], "minimum": 0, "maximum": 100 },
        "mentions_explicit": { "type": "integer", "minimum": 0 },
        "mentions_implicit": { "type": "integer", "minimum": 0 },
        "sources_distinct": { "type": "integer", "minimum": 0 },
        "is_pinned": { "type": "boolean" },
        "is_dormant": { "type": "boolean" },
        "tags": {
          "type": "array",
          "items": { "type": "string" },
          "default": []
        },
        "parent_ids": {
          "type": "array",
          "items": { "type": "string" },
          "default": []
        },
        "child_ids": {
          "type": "array",
          "items": { "type": "string" },
          "default": []
        }
      }
    }
  }
}
